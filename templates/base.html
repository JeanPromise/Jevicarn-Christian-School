<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Jevicarn Christian Kindergarten & School | Juja, Kenya</title>
  <meta name="description" content="Jevicarn Christian Kindergarten & School in Juja, Kenya — energetic, trustworthy, and playful early education.">
  <meta name="author" content="Jevicarn Christian Kindergarten & School">
  <meta property="og:title" content="Jevicarn Christian Kindergarten & School, Juja">
  <meta property="og:description" content="A faith-based school in Juja nurturing bright, kind, and curious learners.">
  <meta property="og:image" content="{{ url_for('static', filename='uploads/hero-example.jpg') }}">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700;800&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">

  <style>
    /* -------------------------
       Base variables (vivid theme = default)
       ------------------------- */
    :root{
      --bg: #0f1724;
      --surface: #071129;
      --card: #0b2130;
      --text: #f7fbfe;
      --muted: #b6c7d6;
      --primary: #6f2dbd;
      --accent: #ff6b35;
      --accent-2: #00c2a8;
      --radius: 12px;
      --shadow-lg: 0 18px 50px rgba(8,12,20,0.6);
      --shadow-sm: 0 8px 22px rgba(2,6,10,0.5);
      --max-width: 1150px;
      font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }

    /* Theme overrides: fresh & calm (toggle will set data-theme on <html>) */
    html[data-theme="fresh"]{
      --bg:#f7fbf8; --surface:#f0fff9; --card:#ffffff; --text:#062925; --muted:#4f6b63;
      --primary:#0ba37f; --accent:#ff8a4d; --accent-2:#3aa0ff;
    }
    html[data-theme="calm"]{
      --bg:#fffaf6; --surface:#fff6f3; --card:#ffffff; --text:#21303a; --muted:#6b7580;
      --primary:#264653; --accent:#e76f51; --accent-2:#2a9d8f;
    }

    /* Reset + layout */
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#07162a);color:var(--text);-webkit-font-smoothing:antialiased;}
    a{color:inherit;text-decoration:none}
    .container{max-width:var(--max-width);margin:0 auto;padding:0 20px}
    .site-header{position:sticky;top:0;z-index:120;background:linear-gradient(90deg, rgba(11,18,36,0.72), rgba(7,14,28,0.72));backdrop-filter: blur(6px);border-bottom:1px solid rgba(255,255,255,0.03)}
    .header-inner{display:flex;align-items:center;justify-content:space-between;padding:18px 0;gap:18px}
    .brand{display:flex;align-items:center;gap:14px}
    .logo{width:64px;height:64px;border-radius:12px;background: linear-gradient(135deg,var(--primary),var(--accent));display:flex;align-items:center;justify-content:center;color:white;font-family:'Montserrat',sans-serif;font-size:20px;font-weight:800;box-shadow:var(--shadow-sm)}
    .brand-name{font-weight:700;font-size:1.05rem;color:var(--text)}
    .tagline{font-size:.78rem;color:var(--muted);margin-top:2px}
    .nav{display:flex;gap:16px;align-items:center}
    .nav a{padding:8px 12px;border-radius:10px;font-weight:600;color:var(--muted);transition:all .18s ease}
    .nav a:hover{background:linear-gradient(90deg,rgba(255,255,255,0.03),rgba(255,255,255,0.01));color:var(--text);transform:translateY(-2px)}
    .btn{display:inline-flex;align-items:center;gap:10px;padding:10px 18px;border-radius:12px;font-weight:700;cursor:pointer}
    .btn-primary{background:linear-gradient(90deg,var(--accent),#ff8a60);color:white;box-shadow:0 12px 30px rgba(255,107,53,0.12);border:0}
    .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    .btn-pill{border-radius:999px;padding:10px 20px}
    main{padding:36px 0}

    /* Hero (kept compact) */
    .hero{padding:24px 0}
    .hero-grid{display:grid;grid-template-columns:1fr 480px;gap:28px;align-items:center}
    .hero-text{background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));padding:32px;border-radius:16px;box-shadow:var(--shadow-lg);border:1px solid rgba(255,255,255,0.03)}
    .hero-text h1{font-family:'Montserrat',sans-serif;margin:0 0 12px;font-size:2.2rem;line-height:1.03;color:var(--text);letter-spacing:0.2px}
    .hero-text .accent{color:var(--accent)}
    .lead{color:var(--muted);font-size:1.05rem;margin-bottom:14px}
    .cta-row{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
    .feature-list{display:flex;gap:10px;padding:0;margin:18px 0 0;list-style:none;flex-wrap:wrap}
    .feature-list li{background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:8px 12px;border-radius:999px;font-weight:700;color:var(--muted);font-size:.95rem}
    .hero-media{border-radius:14px;overflow:hidden;box-shadow:0 20px 60px rgba(7,12,20,0.7);display:block;background:linear-gradient(135deg,var(--primary),var(--accent-2))}
    .hero-media img{width:100%;height:100%;object-fit:cover;display:block;transition:transform .6s ease}
    .hero-media:hover img{transform:scale(1.03)}

    /* Cards + sections (unchanged) */
    section.card{background:transparent}
    .enroll-features{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:18px;margin-top:18px}
    .feature-box{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:18px;border-radius:12px;text-align:center;border:1px solid rgba(255,255,255,0.03)}
    .feature-box .icon{font-size:30px;color:var(--accent)}

    /* ----- GALLERY: two-row horizontal scroller ----- */
    .gallery-preview{margin-top:24px}
    .gallery-preview h2{margin-bottom:12px}
    /* grid flows in columns so thumbnails form TWO rows and scroll horizontally */
    .gallery-preview .grid{
      display:grid;
      grid-auto-flow: column;
      grid-auto-columns: 220px;              /* column size (thumb width) */
      grid-template-rows: repeat(2, 160px);  /* exactly 2 rows */
      gap:12px;
      overflow-x:auto;
      padding-bottom:6px;
      scrollbar-width:thin;
      -webkit-overflow-scrolling:touch;
    }
    .gallery-preview .grid::-webkit-scrollbar{height:10px}
    .gallery-preview .grid::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.06);border-radius:6px}
    .gallery-preview .thumb{width:100%;height:100%;border-radius:10px;overflow:hidden;position:relative;cursor:pointer;flex:0 0 auto}
    .gallery-preview .thumb img{width:100%;height:100%;object-fit:cover;display:block;transition:transform .28s ease}
    .gallery-preview .thumb:hover img{transform:scale(1.05)}
    /* make sure long galleries wrap gracefully on very small screens */
    @media (max-width:420px){ .gallery-preview .grid{grid-auto-columns: 170px; grid-template-rows: repeat(2,120px);} }

    /* ----- LIGHTBOX (modal viewer) ----- */
    .lb-backdrop{position:fixed;inset:0;background:rgba(2,6,10,0.8);display:none;align-items:center;justify-content:center;z-index:150}
    .lb-backdrop.open{display:flex}
    .lb-stage{max-width:92vw;max-height:92vh;position:relative;display:flex;align-items:center;justify-content:center}
    .lb-img{max-width:calc(100vw - 160px);max-height:calc(100vh - 140px);object-fit:contain;border-radius:8px;transition:transform .25s ease}
    .lb-close,.lb-prev,.lb-next,.lb-zoom,.lb-full{
      position:absolute;top:18px;background:rgba(255,255,255,0.06);border-radius:10px;padding:8px;color:var(--text);backdrop-filter:blur(6px);border:0;cursor:pointer
    }
    .lb-prev{left:18px;top:50%;transform:translateY(-50%);padding:12px;border-radius:12px}
    .lb-next{right:18px;top:50%;transform:translateY(-50%);padding:12px;border-radius:12px}
    .lb-close{right:18px}
    .lb-zoom{left:18px;top:18px}
    .lb-full{left:86px;top:18px}
    .lb-footer{position:absolute;bottom:18px;left:50%;transform:translateX(-50%);color:var(--muted);font-weight:600}
    .lb-counter{margin-left:10px;color:var(--muted)}

    /* Footer */
    .site-footer{padding:26px 0;margin-top:48px;background:linear-gradient(90deg, rgba(8,10,20,0.6), rgba(6,8,16,0.6));border-top:1px solid rgba(255,255,255,0.02)}
    .site-footer .container{display:flex;gap:12px;flex-wrap:wrap;justify-content:space-between;align-items:center}
    .footer-left{color:var(--muted);font-weight:600}
    .footer-right{color:var(--muted);font-size:.95rem}

    .whatsapp-float{position:fixed;width:64px;height:64px;bottom:22px;right:22px;background:var(--accent-2);color:#fff;border-radius:16px;display:flex;align-items:center;justify-content:center;z-index:9999;box-shadow:0 14px 40px rgba(0,194,168,0.18)}
    .whatsapp-float img{width:28px;height:28px;filter:brightness(0) invert(1)}

    @media (max-width:980px){ .hero-grid{grid-template-columns:1fr} .nav{display:none} }
  </style>
</head>
<body>
  <div class="site-wrap">
    <header class="site-header">
      <div class="container header-inner">
        <div class="brand">
          <div class="logo">JC</div>
          <div>
            <div class="brand-name">Jevicarn Christian Kindergarten</div>
            <div class="tagline">Educating the whole child • Juja</div>
          </div>
        </div>

        <nav class="nav" aria-label="Primary Navigation">
          <a href="/">Home</a>
          <a href="/programs">Programs</a>
          <a href="/gallery">Gallery</a>
          <a href="/contact">Contact</a>
        </nav>

        <div style="display:flex;align-items:center;gap:12px">
          <button id="themeToggle" class="btn btn-ghost" title="Toggle theme">Theme</button>
          <a class="btn btn-primary btn-pill" href="/contact">Book a Visit</a>

          <button class="mobile-nav-toggle" aria-expanded="false" aria-controls="mobileNav" title="Open menu" style="background:transparent;border:0;color:var(--muted);font-size:18px;">
            <i class="fa fa-bars" aria-hidden="true"></i>
          </button>
        </div>
      </div>

      <div id="mobileNav" class="mobile-nav container" hidden>
        <a href="/">Home</a>
        <a href="/programs">Programs</a>
        <a href="/gallery">Gallery</a>
        <a href="/contact">Contact</a>
      </div>
    </header>

    <main>
      {% block content %}{% endblock %}
    </main>

    <footer class="site-footer" role="contentinfo">
      <div class="container">
        <div class="footer-left">Call / WhatsApp: <strong>+254 781 857 370</strong></div>
        <div class="footer-right">&copy; {{ current_year }} Jevicarn Christian Kindergarten & School — All rights reserved. Built by <strong>Tomorrow Technology Company</strong>.</div>
      </div>
    </footer>
  </div>

  <!-- WhatsApp floating button -->
  <a href="https://wa.me/254781857370" class="whatsapp-float" target="_blank" title="Chat with us on WhatsApp" aria-label="Chat on WhatsApp">
    <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/whatsapp.svg" alt="WhatsApp">
  </a>

  <!-- LIGHTBOX MARKUP -->
  <div id="lightbox" class="lb-backdrop" aria-hidden="true" role="dialog" aria-label="Image viewer">
    <div class="lb-stage" role="document">
      <button class="lb-prev" title="Previous (←)"><i class="fa fa-chevron-left"></i></button>
      <img class="lb-img" src="" alt="Preview">
      <button class="lb-next" title="Next (→)"><i class="fa fa-chevron-right"></i></button>

      <button class="lb-zoom" title="Zoom (z)"><i class="fa fa-search-plus"></i></button>
      <button class="lb-full" title="Fullscreen (f)"><i class="fa fa-expand"></i></button>
      <button class="lb-close" title="Close (Esc)"><i class="fa fa-times"></i></button>

      <div class="lb-footer"><span class="lb-caption"></span><span class="lb-counter"></span></div>
    </div>
  </div>

  <script>
    // -------------------------
    // Theme toggle (cycles through 'vivid' (default), 'fresh', 'calm')
    // -------------------------
    (function(){
      const themes = ['vivid','fresh','calm'];
      // set initial theme from localStorage / default vivid
      const saved = localStorage.getItem('jevicarn_theme') || 'vivid';
      if(saved !== 'vivid') document.documentElement.setAttribute('data-theme', saved);

      const btn = document.getElementById('themeToggle');
      let idx = themes.indexOf(saved);
      btn.addEventListener('click', () => {
        idx = (idx + 1) % themes.length;
        const next = themes[idx];
        if(next === 'vivid') document.documentElement.removeAttribute('data-theme');
        else document.documentElement.setAttribute('data-theme', next);
        localStorage.setItem('jevicarn_theme', next);
        btn.textContent = next.charAt(0).toUpperCase() + next.slice(1);
      });
      // label current
      btn.textContent = (saved === 'vivid' ? 'Vivid' : saved.charAt(0).toUpperCase()+saved.slice(1));
    })();

    // -------------------------
    // Lightbox: click thumbnails -> open, next/prev, keyboard, zoom, fullscreen, swipe
    // -------------------------
    (function(){
      const grid = document.querySelector('.gallery-preview .grid');
      if(!grid) return; // no gallery on page
      const imgs = Array.from(grid.querySelectorAll('img'));
      if(!imgs.length) return;

      const lb = document.getElementById('lightbox');
      const lbImg = lb.querySelector('.lb-img');
      const lbClose = lb.querySelector('.lb-close');
      const lbPrev = lb.querySelector('.lb-prev');
      const lbNext = lb.querySelector('.lb-next');
      const lbZoom = lb.querySelector('.lb-zoom');
      const lbFull = lb.querySelector('.lb-full');
      const lbCounter = lb.querySelector('.lb-counter');
      const lbCaption = lb.querySelector('.lb-caption');

      let index = 0;
      let zoomed = false;

      function openAt(i){
        index = (i + imgs.length) % imgs.length;
        const src = imgs[index].currentSrc || imgs[index].src;
        lbImg.src = src;
        lbCaption.textContent = imgs[index].alt || '';
        lbCounter.textContent = ` ${index+1} / ${imgs.length}`;
        lb.classList.add('open'); lb.setAttribute('aria-hidden','false');
        document.body.style.overflow = 'hidden';
        zoomed = false; lbImg.style.transform = 'scale(1)';
      }

      function closeLB(){ lb.classList.remove('open'); lb.setAttribute('aria-hidden','true'); document.body.style.overflow = ''; }

      function next(){ openAt(index+1); }
      function prev(){ openAt(index-1); }

      // attach clicks
      imgs.forEach((img,i)=> img.addEventListener('click', ()=> openAt(i)));

      lbClose.addEventListener('click', closeLB);
      lbNext.addEventListener('click', next);
      lbPrev.addEventListener('click', prev);

      // keyboard
      window.addEventListener('keydown', (e)=>{
        if(lb.classList.contains('open')){
          if(e.key === 'Escape') closeLB();
          if(e.key === 'ArrowRight') next();
          if(e.key === 'ArrowLeft') prev();
          if(e.key === 'z' || e.key === 'Z') toggleZoom();
          if(e.key === 'f' || e.key === 'F') toggleFull();
        }
      });

      // zoom
      function toggleZoom(){
        zoomed = !zoomed;
        lbImg.style.transform = zoomed ? 'scale(2)' : 'scale(1)';
        lbZoom.innerHTML = zoomed ? '<i class=\"fa fa-search-minus\"></i>' : '<i class=\"fa fa-search-plus\"></i>';
      }
      lbZoom.addEventListener('click', toggleZoom);

      // fullscreen
      function toggleFull(){
        const el = lbImg;
        if(!document.fullscreenElement){
          if(el.requestFullscreen) el.requestFullscreen();
        } else {
          if(document.exitFullscreen) document.exitFullscreen();
        }
      }
      lbFull.addEventListener('click', toggleFull);

      // click backdrop to close (but not clicks on controls)
      lb.addEventListener('click', (e)=>{ if(e.target === lb) closeLB(); });

      // swipe support for touch (simple)
      (function(){
        let startX=0, startY=0;
        lbImg.addEventListener('touchstart', (e)=>{
          const t = e.touches[0]; startX = t.clientX; startY = t.clientY;
        }, {passive:true});
        lbImg.addEventListener('touchend', (e)=>{
          const t = e.changedTouches[0];
          const dx = t.clientX - startX;
          const dy = t.clientY - startY;
          if(Math.abs(dx) > 40 && Math.abs(dx) > Math.abs(dy)){ if(dx < 0) next(); else prev(); }
        });
      })();

      // preload neighbor images for smoothness
      function preload(i){
        const i1 = (i+1)%imgs.length, i2 = (i-1+imgs.length)%imgs.length;
        [i1,i2].forEach(idx=>{
          const im = new Image(); im.src = imgs[idx].src;
        });
      }
      lb.addEventListener('transitionend', ()=> preload(index));
    })();

    // Mobile nav toggle (kept)
    (function(){
      const toggle = document.querySelector('.mobile-nav-toggle');
      const mobile = document.getElementById('mobileNav');
      if(toggle){
        toggle.addEventListener('click',()=>{
          const open = toggle.getAttribute('aria-expanded') === 'true';
          toggle.setAttribute('aria-expanded', String(!open));
          mobile.hidden = open;
        });
      }
    })();
  </script>
</body>
</html>
